(function(){var lastBlurTarget;var CLICK_REACTION_TIME=300;var VALIDATION_INTERVAL=100;var validationIntervalHandle;$R.watermark={};$R.watermark.allWatermarksHandler=[];$R.watermark.updateAllWatermarks=function(){for(var i=0;i<$R.watermark.allWatermarksHandler.length;i++){$R.watermark.allWatermarksHandler[i]();}
}
$R.prototype.watermark=function(watermark_text,css_class_on,css_class_off,options){options=$R.extend({keepWatermarkOnFocus:false
},options||{});var isFocused=false;var watermark_base=$R('<div class="watermark_text">'+$R.escapeHtml(watermark_text)+"</div>");$R.domOps(this,watermark_base,0,function(e,n){var wrapper=$R("<span></span>");var watermark=$R(n);var target=$R(e);var updateWatermarkForceHide=function(){updateWatermark(wrapper,target,watermark,css_class_on,css_class_off,true);};var updateWatermarkInternal=function(){if(options.keepWatermarkOnFocus){updateWatermark(wrapper,target,watermark,css_class_on,css_class_off);}else{updateWatermark(wrapper,target,watermark,css_class_on,css_class_off,isFocused);}
};var updateWatermarkInternalWhenNotEmpty=function(){if(options.keepWatermarkOnFocus){if(target.val()!='')updateWatermark(wrapper,target,watermark,css_class_on,css_class_off);}else{updateWatermark(wrapper,target,watermark,css_class_on,css_class_off,isFocused);}
};updateWatermarkInternal();e.parentNode.insertBefore(wrapper.get(0),e);e.parentNode.removeChild(e);wrapper.append(n);wrapper.append(e);target.css("display","block");wrapper.css({"display":"inline-block","position":"relative","cusor":"text"
});var h=target.outerHeight();var w=target.outerWidth();watermark.css({"position":"absolute","z-index":"1","left":"5px","width":(w-10)+"px","top":"0","line-height":h+"px","overflow":"hidden","white-space":"nowrap","text-overflow":"ellipsis"
});$R.watermark.allWatermarksHandler.push(updateWatermarkInternalWhenNotEmpty);target.keydown($R.watermark.updateAllWatermarks);target.keyup(updateWatermarkInternal);target.bind('change',updateWatermarkInternal);target.bind('paste',updateWatermarkInternal);target.bind('propertychange',updateWatermarkInternal);target.mouseout(updateWatermarkInternal);target.blur(function(){isFocused=false;lastBlurTarget=target;target.data('watermark-focused',0);updateWatermarkInternal();setTimeout(function(){lastBlurTarget=undefined;},CLICK_REACTION_TIME);});if(!validationIntervalHandle){validationIntervalHandle=setInterval(function(){$R.watermark.updateAllWatermarks();},VALIDATION_INTERVAL);}
target.focus(function(){if(lastBlurTarget!=target&&target.data('watermark-focused')||!options.keepWatermarkOnFocus)updateWatermarkForceHide();target.data('watermark-focused',1);lastBlurTarget=target;isFocused=true;});if(options.KeepWatermarkOnFocus){target.dblclick(updateWatermarkForceHide);watermark.dblclick(function(){updateWatermarkForceHide();target.focus();});target.mousedown(function(){if(target.data('watermark-focused'))updateWatermarkForceHide();});watermark.click(function(){if(lastBlurTarget==target)updateWatermarkForceHide();target.focus();});}else{target.mousedown(updateWatermarkForceHide);watermark.click(function(){updateWatermarkForceHide();target.focus();});}
watermark.bind('contextmenu',function(){watermark.collapse();target.focus();setTimeout(function(){watermark.collapse();target.focus();},1);});});return this;};function updateWatermark(wrapper,target,watermark,css_class_on,css_class_off,forceHide){setTimeout(function(){if(target.val()==''&&(forceHide==undefined||!forceHide)){watermark.show();target.trigger('watermark_on');wrapper.removeClass(css_class_off);wrapper.addClass(css_class_on);}else{watermark.collapse();target.trigger('watermark_off');wrapper.removeClass(css_class_on);wrapper.addClass(css_class_off);}
},1);}
})();